{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { finalize } from 'rxjs/operators';\nimport { ArtworkType } from '../models/artwork.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/artwork.service\";\nimport * as i2 from \"../services/artist.service\";\nexport class ArtworkListViewModel {\n  constructor(artworkService, artistService) {\n    this.artworkService = artworkService;\n    this.artistService = artistService;\n    this.artworksSubject = new BehaviorSubject([]);\n    this.artworks$ = this.artworksSubject.asObservable();\n    this.artistsSubject = new BehaviorSubject([]);\n    this.artists$ = this.artistsSubject.asObservable();\n    this.loadingSubject = new BehaviorSubject(false);\n    this.loading$ = this.loadingSubject.asObservable();\n    this.errorSubject = new BehaviorSubject(null);\n    this.error$ = this.errorSubject.asObservable();\n    this.searchQuerySubject = new BehaviorSubject('');\n    this.searchQuery$ = this.searchQuerySubject.asObservable();\n    this.filterSubject = new BehaviorSubject({});\n    this.filter$ = this.filterSubject.asObservable();\n    // Artwork types for filter dropdown\n    this.artworkTypes = Object.values(ArtworkType);\n  }\n  loadArtworks() {\n    this.loadingSubject.next(true);\n    this.errorSubject.next(null);\n    this.artworkService.getArtworks().pipe(finalize(() => this.loadingSubject.next(false))).subscribe(artworks => this.artworksSubject.next(artworks), error => this.errorSubject.next('Failed to load artworks. Please try again later.'));\n  }\n  loadArtists() {\n    this.artistService.getArtists().subscribe(artists => this.artistsSubject.next(artists), error => this.errorSubject.next('Failed to load artists for filter. Please try again later.'));\n  }\n  searchArtworks(query) {\n    this.searchQuerySubject.next(query);\n    if (!query.trim()) {\n      this.loadArtworks();\n      return;\n    }\n    this.loadingSubject.next(true);\n    this.errorSubject.next(null);\n    this.artworkService.searchArtworks(query).pipe(finalize(() => this.loadingSubject.next(false))).subscribe(artworks => this.artworksSubject.next(artworks), error => this.errorSubject.next('Failed to search artworks. Please try again later.'));\n  }\n  filterArtworks(filter) {\n    this.filterSubject.next(filter);\n    this.loadingSubject.next(true);\n    this.errorSubject.next(null);\n    this.artworkService.filterArtworks(filter).pipe(finalize(() => this.loadingSubject.next(false))).subscribe(artworks => this.artworksSubject.next(artworks), error => this.errorSubject.next('Failed to filter artworks. Please try again later.'));\n  }\n  clearFilters() {\n    this.filterSubject.next({});\n    this.loadArtworks();\n  }\n  clearSearch() {\n    this.searchQuerySubject.next('');\n    this.loadArtworks();\n  }\n  static {\n    this.ɵfac = function ArtworkListViewModel_Factory(t) {\n      return new (t || ArtworkListViewModel)(i0.ɵɵinject(i1.ArtworkService), i0.ɵɵinject(i2.ArtistService));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: ArtworkListViewModel,\n      factory: ArtworkListViewModel.ɵfac\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","finalize","ArtworkType","ArtworkListViewModel","constructor","artworkService","artistService","artworksSubject","artworks$","asObservable","artistsSubject","artists$","loadingSubject","loading$","errorSubject","error$","searchQuerySubject","searchQuery$","filterSubject","filter$","artworkTypes","Object","values","loadArtworks","next","getArtworks","pipe","subscribe","artworks","error","loadArtists","getArtists","artists","searchArtworks","query","trim","filterArtworks","filter","clearFilters","clearSearch","i0","ɵɵinject","i1","ArtworkService","i2","ArtistService","factory","ɵfac"],"sources":["C:\\fac\\an3_sem2\\ps\\proiect_ps - Copy (2)\\art-gallery-frontend\\src\\app\\view-models\\artwork-list.view-model.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { finalize } from 'rxjs/operators';\r\nimport { ArtworkService } from '../services/artwork.service';\r\nimport { ArtistService } from '../services/artist.service';\r\nimport { ArtworkListItem, ArtworkFilter, ArtworkType } from '../models/artwork.model';\r\nimport { ArtistListItem } from '../models/artist.model';\r\n\r\n@Injectable()\r\nexport class ArtworkListViewModel {\r\n  private artworksSubject = new BehaviorSubject<ArtworkListItem[]>([]);\r\n  public artworks$ = this.artworksSubject.asObservable();\r\n  \r\n  private artistsSubject = new BehaviorSubject<ArtistListItem[]>([]);\r\n  public artists$ = this.artistsSubject.asObservable();\r\n  \r\n  private loadingSubject = new BehaviorSubject<boolean>(false);\r\n  public loading$ = this.loadingSubject.asObservable();\r\n  \r\n  private errorSubject = new BehaviorSubject<string | null>(null);\r\n  public error$ = this.errorSubject.asObservable();\r\n  \r\n  private searchQuerySubject = new BehaviorSubject<string>('');\r\n  public searchQuery$ = this.searchQuerySubject.asObservable();\r\n  \r\n  private filterSubject = new BehaviorSubject<ArtworkFilter>({});\r\n  public filter$ = this.filterSubject.asObservable();\r\n  \r\n  // Artwork types for filter dropdown\r\n  public artworkTypes = Object.values(ArtworkType);\r\n\r\n  constructor(\r\n    private artworkService: ArtworkService,\r\n    private artistService: ArtistService\r\n  ) {}\r\n\r\n  loadArtworks(): void {\r\n    this.loadingSubject.next(true);\r\n    this.errorSubject.next(null);\r\n    \r\n    this.artworkService.getArtworks()\r\n      .pipe(\r\n        finalize(() => this.loadingSubject.next(false))\r\n      )\r\n      .subscribe(\r\n        artworks => this.artworksSubject.next(artworks),\r\n        error => this.errorSubject.next('Failed to load artworks. Please try again later.')\r\n      );\r\n  }\r\n\r\n  loadArtists(): void {\r\n    this.artistService.getArtists()\r\n      .subscribe(\r\n        artists => this.artistsSubject.next(artists),\r\n        error => this.errorSubject.next('Failed to load artists for filter. Please try again later.')\r\n      );\r\n  }\r\n\r\n  searchArtworks(query: string): void {\r\n    this.searchQuerySubject.next(query);\r\n    \r\n    if (!query.trim()) {\r\n      this.loadArtworks();\r\n      return;\r\n    }\r\n    \r\n    this.loadingSubject.next(true);\r\n    this.errorSubject.next(null);\r\n    \r\n    this.artworkService.searchArtworks(query)\r\n      .pipe(\r\n        finalize(() => this.loadingSubject.next(false))\r\n      )\r\n      .subscribe(\r\n        artworks => this.artworksSubject.next(artworks),\r\n        error => this.errorSubject.next('Failed to search artworks. Please try again later.')\r\n      );\r\n  }\r\n\r\n  filterArtworks(filter: ArtworkFilter): void {\r\n    this.filterSubject.next(filter);\r\n    this.loadingSubject.next(true);\r\n    this.errorSubject.next(null);\r\n    \r\n    this.artworkService.filterArtworks(filter)\r\n      .pipe(\r\n        finalize(() => this.loadingSubject.next(false))\r\n      )\r\n      .subscribe(\r\n        artworks => this.artworksSubject.next(artworks),\r\n        error => this.errorSubject.next('Failed to filter artworks. Please try again later.')\r\n      );\r\n  }\r\n\r\n  clearFilters(): void {\r\n    this.filterSubject.next({});\r\n    this.loadArtworks();\r\n  }\r\n\r\n  clearSearch(): void {\r\n    this.searchQuerySubject.next('');\r\n    this.loadArtworks();\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}